<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.springbootstudy.app.mapper.RecipeMapper">


<!-- 레시피 추가하기 -->
<insert id="insertBoard" parameterType="RecipeBoard" useGeneratedKeys="true" keyProperty="boardNo">
    INSERT INTO recipe_Board (food_name, board_title, board_content, food_genre, member_id)
    VALUES (#{foodName}, #{boardTitle}, #{boardContent}, #{foodGenre}, #{memberId});
</insert>
<!-- 레시피에 요리재료추가하기 -->
<insert id="insertMaterial" parameterType="Material" useGeneratedKeys="true" keyProperty="boardNo">
    INSERT INTO material (board_No, material_name, mensuration, type_Material)
    VALUES (#{boardNo}, #{materialName}, #{mensuration}, #{typeMaterial});
</insert>
<!-- 레시피 재료리스트로 바로 불러오기 -->

<!-- 레시피에 요리과정추가하기 -->
<insert id="insertCooking" parameterType="Cooking" useGeneratedKeys="true" keyProperty="boardNo">
    INSERT INTO cooking (board_No, cook_title, cook_Method, recommended)
    VALUES (#{boardNo}, #{cookTitle}, #{cookMethod}, #{recommended});
</insert>
<!-- 요리과정의 요리재료 추가하기 -->
<insert id="insertCookMaterial" parameterType="CookMaterial" useGeneratedKeys="true" keyProperty="boardNo">
    INSERT INTO cook_material (cooking_id, material_id, board_No)
    VALUES (#{cookingId}, #{materialId}, #{boardNo});
</insert>

	
	<update id="updateBoard">
	</update>
	
	
  <!-- boardNO의 요리과정리스트 -->
<select id="getCookList" resultType="Cooking"  parameterType="int">
SELECT c.*
FROM recipe_board rb
INNER JOIN cooking c ON rb.board_no = c.board_no
WHERE rb.board_no = #{boardNo};
</select>
	
	<!--요리과정 재료-->
	<select id="cookMaterList" parameterType="hashmap">
		SELECT m.*
		FROM cook_material cm
		INNER JOIN material m ON cm.material_id = m.material_id WHERE cm.cooking_id = #{cookingId} AND cm.board_No = #{boardNo};
	</select>	
	
	<!--레시피 리스트-->
	<select id="recipeBoardList">
		select * from Recipe_Board order by board_No desc
	</select>
	
	<!--레시피 boardNo 가져오기 Detail-->
	<select id="getBoard"  resultType="RecipeBoard">
		select * from Recipe_Board where board_no = #{boardNo};
	</select>

  
  <!--cookid를 가져오기위함 -->
 	<select id="cookidCheck" resultType="int">
    SELECT c.cooking_id
	FROM recipe_board rb
	INNER JOIN cooking c ON rb.board_no = c.board_no
	WHERE rb.board_no = #{boardNo} ;
  </select>
  
  <!--bookpage 를 나타냄-->
  <select id="cookCount" resultType="int">
    SELECT count(*)
	FROM recipe_board rb
	INNER JOIN cooking c ON rb.board_no = c.board_no
	WHERE rb.board_no = #{boardNo};

  </select>
  <!--boardNo의 재료들 출력-->
  <select id="getMaterialList" resultType="Material">
    SELECT m.*
	FROM recipe_board rb
	INNER JOIN material m ON rb.board_no = m.board_no
	WHERE rb.board_no = #{boardNo};
  </select>
</mapper>
