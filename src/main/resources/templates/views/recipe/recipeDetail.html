<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/main_layout}">

<head>
<!-- <link rel="stylesheet" type="text/css" th:href="@{/css/recipeList.css}" /> -->
<link href="css/recipeDetail.css" rel="stylesheet">
<!-- Bootstrap CSS -->
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
	rel="stylesheet">
<script src="js/recipe/recipeBook.js"></script>
<script src="js/recipe/recipeList.js"></script>
<script src="js/recipe/comment.js"></script>
<style>
html {
	scroll-behavior: smooth;
}
</style>
</head>

<body>
	<!-- content -->
	<div layout:fragment="content"
		class="container-fluid custom-container px-4">
		<div class="inner-content px-2">
			<form id="recipeDetailForm">
				<input type="hidden" id="boardNo" th:value="${rList.boardNo}"name="boardNo"> 
				<input type="hidden" id="cookingId"	th:value="${cookingId}" name="cookingId"> 
				<input	type="hidden" id="bookCount" th:value="${bookCount}"	name="bookCount"> 
				<input type="hidden" id="id" name="id"		th:value="${rList.memberId}">
				<input type="hidden" id="searchOption" th:value="${searchOption}"/>
				<th:block th:if="${session.member != null and session.member != ''}">
					<input type="hidden" id="loginId" name="loginId"th:value="${session.member.id}">
				</th:block>
					<input type="hidden" name="pageNum"id="pageNum" th:value="${pageNum}" />
				<th:block th:if="${searchOption}">
						<input type="hidden" id="type" name="type" th:value="${type}">
						<input type="hidden" id="keyword" name="keyword" th:value="${keyword}">
				</th:block>
				
				<input type="hidden" id="commentCount" name="commentCount"
					th:value="${commentCount}" /> <input type="hidden"
					id="averagePoint" name="averagePoint" th:value="${averagePoint}">
			</form>
			<div class="row">
				<div class="col">
					<div class="row rList">
						
						<div class="col">
							<div class="recipe-collection text-center">
								<div class="col-12">
									<div class="row">
										<div class="col recipe-collection-title">
											<div class="row d-flex  align-items-center">

												<div class="col-2">
													<input class="write-button" type="button" id="scrollButton"
														value="Î¶¨Î∑∞Î≥¥Í∏∞">
												</div>
												<div class="col-2">
													<th:block th:if="${searchOption}">
														<input class="btn btn-primary" type="button" value="Î™©Î°ùÎ≥¥Í∏∞"
															th:onclick="@{|location.href='recipeList?pageNum=${pageNum}&type=${type}&keyword=${keyword}'|}" />
													</th:block>
													<th:block th:unless="${searchOption}">
														<input class="btn btn-primary" type="button" value="Î™©Î°ùÎ≥¥Í∏∞"
															th:onclick="@{|location.href='recipeList?pageNum=${pageNum}'|}" />
													</th:block>
												</div>
												<div class="col-4">
													<h3 class="text-center my-3 fw-bold ">Î†àÏãúÌîº Î™®ÏïÑÎ≥¥Í∏∞</h3>
												</div>
												<th:block
													th:if="${session.member != null and session.member.id == rList.memberId}">
													<div class="col-2">
														<input class="comment-edit btn-sm" type="button"
															id="updateDetailBtn" value="ÏàòÏ†ïÌïòÍ∏∞" />
													</div>
													<div class="col-2">
														<input class="comment-delete btn-sm" type="button"
															id="deleteDetailBtn" value="ÏÇ≠Ï†úÌïòÍ∏∞" />
													</div>
												</th:block>
											</div>
										</div>
									</div>
									<div class="row">
										<div
											class="col text-end text-white d-flex justify-content-end align-items-center">
											<button type="button" class="btn btn-success" id="bookBtn">Ï±Ö
												Ïó¥Í∏∞</button>
										</div>
									</div>
								</div>
								<div class="row my-2">
									<div class="col">
										<div class="row">
											<div class="col">
												<h3 class="text-center my-3 fw-bold">ÏöîÎ¶¨ Ïû¨Î£å</h3>
											</div>
										</div>
										<div class="row border justify-content-start">
											<th:block th:each="mList, cStatus : ${mList}">
												<div class="col-6">
													<ul>
														<li>
															<div class="row my-1">
																<div class="col">[[${mList.materialName}]]</div>
																<div class="col">[[${mList.mensuration}]]</div>
															</div>
														</li>
													</ul>
												</div>
											</th:block>
										</div>
									</div>
								</div>
								<th:block th:each="cList, cStatus : ${cList}">
									<div class="row border border-danger my-2">
										<div class="col">
											<div class="row my-2 border border-dark rounded"
												style="height: 300px;">
												<div class="col-5">
													<div class="row">
														<div class="col mx-4">
															<th:block th:if="${cList.cookFile != null and cList.cookFile != ''}">
																<img
																	th:src="@{'./uploads/cooking/' + ${cList.cookFile}}"
																	alt="ÏÉòÌîåÏù¥ÎØ∏ÏßÄ" class="img-fluid"
																	style="height: 300px; width: 300px;">
															</th:block>
															<th:block
																th:unless="${cList.cookFile != null and cList.cookFile != ''}">
																<img src="https://via.placeholder.com/300" alt="ÏÉòÌîåÏù¥ÎØ∏ÏßÄ"
																	class="img-fluid">
															</th:block>
														</div>
													</div>
												</div>
												<div class="col">
													<div class="row my-2">
														<div class="col">
															<h4 class="fw-bold">
																Step .<span th:text="${cStatus.index + 1}"></span>
															</h4>
														</div>
													</div>
													<div class="row my-1">
														<div class="col">
															<h4>Ï°∞Î¶¨Î∞©Î≤ï</h4>
														</div>
													</div>
													<div class="row my-1">
														<div class="col my-2">
															<span>[[${cList.cookMethod}]]</span>
														</div>
													</div>
													<th:block
														th:if="${not #strings.isEmpty(cList.recommended)}">
														<div class="row my-1">
															<div class="col my-2">
																<h4>Ï£ºÏùòÌï†Ï†ê</h4>
															</div>
														</div>
														<div class="row my-1">
															<div class="col my-2">
																<span th:text="${cList.recommended}"></span>
															</div>
														</div>
													</th:block>
												</div>
											</div>

										</div>
									</div>
								</th:block>
							</div>
						</div>

					</div>
					<!-- ÎåìÍ∏ÄÌèº -->
					<!-- ÎåìÍ∏Ä ÏûëÏÑ± Ìèº -->
					<div class="row my-4 cook-comments" id="sectionComment">
						<div class="col-3"></div>
						<div class="col-6">
							<h3 class="text-center fw-bold">ÏöîÎ¶¨ ÌõÑÍ∏∞</h3>
						</div>
						<div
							class="col-3 text-end text-white d-flex justify-content-end align-items-center">
							<button type="button" class="btn btn-success" id="commentBtn">Îß® ÏúÑÎ°ú</button>
						</div>
					</div>
					<div id="reviewSection">
						<div class="mb-4">
							<div class="review-write">
								<div class="row">
									<div class="col">
										<h5 class="comment-title">ÌõÑÍ∏∞ ÏûëÏÑ±</h5>
									</div>
								</div>
							</div>
							<div class="comment-body">
								<form id="commentForm" method="post">
									<div class="mb-3"></div>
									<div class="row my-2 d-flex align-items-center">
										<div class="col-1">
											<label for="commentPoint"
												class="form-label commentPoint fw-bold">Ìèâ&nbsp;&nbsp;Ï†ê&nbsp;&nbsp;:&nbsp;
											</label>

										</div>
										<div class="col-2">
											<select class="form-select" id="commentPoint"
												name="commentPoint" required>
												<option value="">ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
												<option value="1">1Ï†ê</option>
												<option value="2">2Ï†ê</option>
												<option value="3">3Ï†ê</option>
												<option value="4">4Ï†ê</option>
												<option value="5">5Ï†ê</option>
											</select>
											<!-- <input type="number" class="form-control w-3"
													id="commentPoint" name="commentPoint" min="0" max="5"
													placeholder="1~5Ï†ê" required> -->
										</div>
									</div>

									<div class="comment-input-section">
										<div
											class="row d-flex justify-content-between align-items-center my-2">
											<div class="col-10">
												<textarea class="form-control" id="commentContent"
													name="commentContent" rows="2" required></textarea>
											</div>
											<div class="col-2">
												<button type="submit" class="write-button-comment"
													style="height: 60px;">ÌõÑÍ∏∞ ÏûëÏÑ±ÌïòÍ∏∞</button>
											</div>
										</div>
									</div>
								</form>
							</div>
						</div>
					</div>
					<!-- ÎåìÍ∏Ä Î¶¨Ïä§Ìä∏ -->
					<div class="review-write">
						<div class="row">
							<div class="col-6">
								<h5 class="comment-lists">ÌõÑÍ∏∞ Î¶¨Ïä§Ìä∏</h5>
							</div>
							<div class="col-6 text-end">
								<div class="average-score">
									<span>ÌèâÍ∑† Ï†êÏàò :</span>
									<div id="star-container" class="arg-star">
										<span id="stars" th:utext="${stars}"></span>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="card-body">
						<ul class="list-group" id="commentList">
							<!-- ÎåìÍ∏Ä ÏïÑÏù¥ÌÖú -->
							<th:block th:if="${not #lists.isEmpty(commentList)}">
								<th:block th:each="comment : ${commentList}">
									<li class="list-group-item my-2"
										th:data-comment-id="${comment.commentId}">
										<div class="d-flex justify-content-between">
											<div>
												<p class="mb-1">
													<strong>[[${comment.memberId}]]</strong>
												</p>
												<p class="mb-1 comment-content">[[${comment.commentContent}]]</p>
												<span class="text-muted" name="createdAt"
													th:text="${#dates.format(comment.createdAt,
															'yyyy-MM-dd')}"></span>
												<div class="star-icons">
													<th:block th:if="${comment.commentPoint > 0}">
														<th:block
															th:each="star : ${#numbers.sequence(1, comment.commentPoint)}">
															<i class="bi bi-star-fill"></i>
														</th:block>
													</th:block>
													<th:block th:if="${comment.commentPoint < 5}">
														<th:block
															th:each="star : ${#numbers.sequence(comment.commentPoint + 1, 5)}">
															<i class="bi bi-star"></i>
														</th:block>
													</th:block>
												</div>
											</div>
											<div>
												<th:block
													th:if="${session.member != null and session.member.id != null and comment.memberId != null and session.member.id == comment.memberId}">
													<button class="comment-edit btn-sm"
														onclick="editComment(this)">ÏàòÏ†ï</button>
													<button class="comment-delete btn-sm"
														onclick="deleteComment(this)">ÏÇ≠Ï†ú</button>
												</th:block>
											</div>
										</div>
									</li>
								</th:block>
							</th:block>
							<!-- ÎåìÍ∏ÄÏù¥ ÏóÜÎäî Í≤ΩÏö∞ -->
							<th:block th:if="${#lists.isEmpty(commentList)}">
								<span class="list-group-item2 my-2" id="falseText">ÌõÑÍ∏∞Í∞Ä
									Ï°¥Ïû¨ÌïòÏßÄ ÏïäÏäµÎãàÎã§.üòÖ</span>
							</th:block>
							<!-- Îçî ÎßéÏùÄ ÎåìÍ∏Ä ÏïÑÏù¥ÌÖúÎì§ -->
						</ul>
					</div>
					<!-- ÎåìÍ∏ÄÌèºÎßàÎ¨¥Î¶¨ -->


				</div>

			</div>
			<!-- <div class="row text-center my-5">

				<div class="col">
					<input class="write-button" type="button" id="bookBtn"
						value="Î†àÏãúÌîºÎ≥¥Í∏∞(Ï±Ö)">
				</div>
				<div class="col">
					<input class="write-button" type="button" id="listBtn"
						value="Î†àÏãúÌîºÎ≥¥Í∏∞(Î¶¨Ïä§Ìä∏)">
				</div>

			</div> -->
		</div>

	</div>
	<!-- Bootstrap Bundle with Popper -->
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
